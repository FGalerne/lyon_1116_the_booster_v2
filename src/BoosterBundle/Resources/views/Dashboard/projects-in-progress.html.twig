<section class="container-fluid presentation-booster" id="dashboard-booster-inProgress">
    {% for project in projects %}
        {% set showSubscriptions = 1 %}
        {% if project.status != 'Open' %}
            {% set showSubscriptions = 0 %}
        {% endif %}
            {% if project.status != 'Done' and project.creationStatus == true %}
                <div class="container project-in-progress prelude">
                    <div class="row">
                        <div class="col-xs-6 col-md-3">
                            <p>Nom de la société</p>
                            <p>{{ society.societyName }}</p>
                        </div>
                        <div class="col-xs-6 col-md-3">
                            <p>Nom du projet :</p>
                            <p>{{ project.projectName }}</p>
                        </div>
                        <div class="col-xs-6 col-md-2">
                            <p>Nombre d'heures:</p>
                            <p>{{ project.givenTime }}</p>
                        </div>
                        <div class="col-xs-6 col-md-2">
                            <p>Catégorie:</p>
                            <p>{{ project.category }}</p>
                        </div>
                        <div class="col-xs-6 col-md-2">
                            <p>Statut:</p>
                            <p>{{ project.status }}</p>
                        </div>
                        <div class="col-xs-12 ">
                            <p class="text-left">{{ project.description }}</p>
                        </div>
                    </div>

                    {% for subscription in project.projectSubscriptions %}
                        {% if showSubscriptions %}
                            <div class="sub-container row">
                                <div class="col-xs-3">
                                    <div class="col-xs-6">
                                        <em class="text-left">{{ subscription.createTime|date('Y-m-d') }}</em><br/>
                                        <em class="text-left">{{ subscription.createTime|date('H:i:s') }}</em><br/>
                                    </div>
                                    <div class="col-xs-6 avatar-messenger">
                                        <img src="{{ subscription.booster.photo|default ? asset('img/uploads/boosters/' ~ subscription.booster.photo) : asset('img/photo-couverture-profile-societe.png') }}" alt="photo-avatar"/>
                                    </div>
                                </div>
                                <div class="col-xs-6">
                                    <p class="text-left"><strong>{{ subscription.booster.user.firstName }}</strong> : {{ subscription.message }}</p>
                                </div>
                                <div class="col-xs-1">
                                    <p class="text-left"><strong>{{ subscription.givenTime }} H</strong></p>
                                </div>
                                {% if subscription.project.status == 'Open' and subscription.status == 'Open' %}
                                {# we allow society to contact and see subscribers if noone has been chosen yet #}
                                <div class="col-xs-2">
                                    <a href="{{ path('dashboard_booster', {'id': subscription.booster.id }) }}" title="Le voir">
                                        Le voir
                                    </a><br/>
                                    <a href="{{ path('dashboard_contact_booster', {'societyId': app.user.society.id, 'projectId': subscription.project.id, 'subscriptionId': subscription.id }) }}" title="Le contacter">
                                        Le contacter
                                    </a>
                                </div>
                                {% elseif subscription.project.status == 'In_progress' %}
                                    {# if the society already has chosen a subscriber it can't se the subscribers dashboard and canot contact them #}
                                    <div class="col-xs-2">
                                        <a title="En cours">projet en cours de réalisation</a>
                                    </div>
                                {% elseif subscription.project.status == 'Open' and subscription.status == 'Canceled' %}
                                    {# if subscription has been canceled #}
                                    <div class="col-xs-2">
                                        <a title="En cours">La collaboration à été annulée</a>
                                    </div>
                                {% endif %}
                            </div>

                        {% else %}
                            <div class="sub-container row">
                                    <div class="col-xs-8">
                                        Projet en cours de réalisation !
                                    </div>
                                    <div class="col-xs-4">
                                        {% if not subscription.societyValidation %}
                                        <a href="{{ path('project_done', {'projectId': subscription.project.id, 'subscriptionId': subscription.id, 'dashboardId': app.user.society.id, 'role': 'society' }) }}" class="button-cancel-subscription">Ce projet est terminé !</a><br/>
                                        {% else %}
                                            En attente de la validation de {{ subscription.booster.user.firstname }}.<br/>
                                        {% endif %}
                                        <a data-toggle="collapse" data-target="#collapseCancel" class="button-cancel-subscription">Annuler la collaboration</a>
                                    </div>

                            </div>
                            {#Collapse for cancelation confirmation#}
                            <div id="collapseCancel" class="collapse">
                                <div> <strong>Attention, en annulant cette collaboration, vous n'aurez plus la possibilité de terminer ce projet avec {{ subscription.booster.user.firstName }}: </strong><br/>
                                <a href="{{ path('subscription_cancel', {'projectId': subscription.project.id, 'subscriptionId': subscription.id, 'dashboardId': app.user.society.id, 'role': 'society' }) }}">Je confirme l'annulation</a>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}

                {% endif %}
            </div>
    {% endfor %}
</section>